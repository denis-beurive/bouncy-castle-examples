# Anatomy of a secret key ring

Let's dump the content of the PGP document generated by [this example program](../app-pgp-keyring/README.md):

    $ gpg --list-packets --verbose pgp-packets-secret-keyring/secret-keyring-bin.pgp

## First packet

Data:
    
    # off=0 ctb=95 tag=5 hlen=3 plen=516
    :secret key packet:
            version 4, algo 1, created 1588776506, expires 0
            pkey[0]: C508AE1F60C55B73B7C8E8CFD86231C0482FC0259EE9134823C40C8B29B9A25C31C48E59513159D3950F7469ED255C4EEFB99A7C5917F31B24844639EC43BADBA67ABDF320C2599272C5DFE54C0F9D755BDB71DFFA48F0E0C6462F5084BDC86B258159FFEEA1BD922D268C
    5E1B95064DF3DBAD89D677ED12C1BD653BBEB58A03
            pkey[1]: 11
            iter+salt S2K, algo: 9, SHA1 protection, hash: 8, salt: 9F19C866F9DF00F4
            protect count: 65536 (96)
            protect IV:  70 eb 09 93 8c cf 0a bc fc 0f c9 60 c7 59 8e 46
            skey[2]: [v4 protected]
            keyid: EFC852091E95E75C

* **packet attributes**:
  * `off=0`: the beginning of the packet coincides with the beginning of the document.
  * `ctb=95`: this is the first byte of the packet (`0x95`).
  * `tag=5`: [Secret-Key Packet](https://tools.ietf.org/html/rfc4880#section-5.5.1.3)
  * `hlen=3`: this is the length of the header.
  * `plen=516`: this is the length of the payload.
* **secret key packet**:
  * `version 4`: [Public-Key Packet Formats - version 4](https://tools.ietf.org/html/rfc4880#section-5.5.2)
  * `algo=1`: [RSA (Encrypt or Sign)](https://tools.ietf.org/html/rfc4880#section-9.1)
  * `created 1588776506`: mercredi 6 mai 2020 16:48:26 GMT+02:00 [DST]
  * `expires 0`: no expiration date
  * `pkey[0]`: the first [MPI](https://tools.ietf.org/html/rfc4880#section-3.2) for the RSA public key.
  * `pkey[1]`: the second [MPI](https://tools.ietf.org/html/rfc4880#section-3.2) for the RSA public key.
  * `iter+salt S2K`: [Iterated and Salted S2K](https://tools.ietf.org/html/rfc4880#section-3.7.1.3)
  * `algo: 9`: [AES with 256-bit key](https://tools.ietf.org/html/rfc4880#section-9.2)
  * `hash: 8`: [SHA256](https://tools.ietf.org/html/rfc4880#section-9.4)
  * `salt: 9F19C866F9DF00F4`: see [Iterated and Salted S2K](https://tools.ietf.org/html/rfc4880#section-3.7.1.3).
  * `protect count: 65536 (96)`: see [Iterated and Salted S2K](https://tools.ietf.org/html/rfc4880#section-3.7.1.3).
  * `protect IV`: see [Secret-Key Packet Formats](https://tools.ietf.org/html/rfc4880#section-5.5.3):
    If secret data is encrypted (string-to-key usage octet not zero), an Initial Vector (IV) of the same length as the
    cipher's block size. The block size is: 128 bits (see [wikipedia](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard)), 16 bytes.
  * `skey[2]`: encrypted private key material.
  * `keyid: EFC852091E95E75C`: the key ID (based on the public key).
      
## Second packet
              
Data:
        
    # off=295 ctb=b4 tag=13 hlen=2 plen=15
    :user ID packet: "denis@email.com"
    
* **packet attributes**:
  * `off=519`: the packet data starts 519 bytes after the beginning of the document.
  * `ctb=b4`: this is the first byte of the packet (`0xB4`).
  * `tag=13`: [User ID Packet](https://tools.ietf.org/html/rfc4880#section-4.3)
  * `hlen=2`: this is the length of the header.
  * `plen=15`: this is the length of the payload.

## Third packet

Data:

    # off=536 ctb=88 tag=2 hlen=2 plen=156
    :signature packet: algo 1, keyid EFC852091E95E75C
            version 4, created 1588776507, md5len 0, sigclass 0x10
            digest algo 8, begin of digest 68 b3
            hashed subpkt 2 len 4 (sig created 2020-05-06)
            subpkt 16 len 8 (issuer key ID EFC852091E95E75C)
            data: AF1BAF3C569CDA34ACD07DD07E2850DFC49B89A6C1402DAA5D997956B201142B1DDF5CA9C4B105A63F099E6471B97120D710D3519B9541C7C0E0F65B6207348789829D987CD89A253F3429442007477195055E5CC110397805A5D62017665D888466386944E52EBB1A8FC5CADEC5086984BB23AC5116F41AD856C3CA5F1778C7
        
* **packet attributes**:
  * `off=536`: the packet data starts 536 bytes after the beginning of the document.
  * `ctb=88`: this is the first byte of the packet (`0x88`).
  * `tag=2`: [Signature Packet](https://tools.ietf.org/html/rfc4880#section-4.3)
  * `hlen=2`: this is the length of the header.
  * `plen=156`: this is the length of the payload.
* **signature packet**:
  * `version 4`: [Version 4 Signature Packet Format](https://tools.ietf.org/html/rfc4880#section-5.2.3)
  * `created 1588776507`: mercredi 6 mai 2020 16:48:27 GMT+02:00 DST
  * `md5len 0`:
  * `sigclass 0x10`: [Generic certification of a User ID and Public-Key packet.](https://tools.ietf.org/html/rfc4880#section-5.2.1)
  * `digest algo 8`: [SHA256](https://tools.ietf.org/html/rfc4880#section-9.4)
  * `hashed subpkt 2 len 4`:
    * `2` represents the type of the subpacket ([Signature Creation Time](https://tools.ietf.org/html/rfc4880#section-5.2.3.1)).
    * `4` represents the length of the subpacket body (4 bytes).
  * `subpkt 16 len 8`:
    * `16` represents the type of the subpacket ([Issuer](https://tools.ietf.org/html/rfc4880#section-5.2.3.1)).
    * `8` represents the length of the subpacket.
  * `data: AF1BAF3C569C...`: this represents the multiprecision integer (MPI) of RSA signature value m**d mod n
    (see [Version 3 Signature Packet](https://tools.ietf.org/html/rfc4880#section-5.2.2)).
        
## Fourth packet
        
Data:

    # off=694 ctb=9d tag=7 hlen=3 plen=516
    :secret sub key packet:
            version 4, algo 1, created 1588776507, expires 0
            pkey[0]: D7438BD357572AD0197BE494621E35FC713EDF80204273E223F05212C35F7CC07E232BB8F8C61D78EF6C79234A369914638357B27242C28F628615B419D508817E0BE202DBDE06D8E319ABB854CC0A744055E35C594D0F519136633A6F1CF5EF9D864F0A7DA539FD1B743A
    0529FC2B9CEF4539232837B34BA40254BF27D7EC13
            pkey[1]: 11
            iter+salt S2K, algo: 9, SHA1 protection, hash: 8, salt: 9F19C866F9DF00F4
            protect count: 65536 (96)
            protect IV:  c5 92 fb ad 4e 62 40 06 f2 22 66 77 1d 17 ea 6f
            skey[2]: [v4 protected]
            keyid: E14F4509FB6F57AF

* **packet attributes**:
  * `off=694`: the packet data starts 694 bytes after the beginning of the document.
  * `ctb=9d`: this is the first byte of the packet (`0x9C`).
  * `tag=7`: [Secret-Subkey Packet](https://tools.ietf.org/html/rfc4880#section-4.3)
  * `hlen=3`: this is the length of the header.
  * `plen=516`: this is the length of the payload.
* **secret subkey**:
  * `version 4`: [version 4 Public-Key Packet](https://tools.ietf.org/html/rfc4880#section-5.5.2)
  * `algo 1`: [RSA](https://tools.ietf.org/html/rfc4880#section-9.1)
  * `created 1588776507`: Wednesday 6 May 2020 14:48:27 [GMT]
  * `expires 0`: the key does not expire.
* **public subkey**:
  * `pkey[0]`: `D7438BD35757...` this is the first [Multiprecision Integers](https://tools.ietf.org/html/rfc4880#section-3.2) that makes the public key.
  * `pkey[1]`: `11` the is the second [Multiprecision Integers](https://tools.ietf.org/html/rfc4880#section-3.2) that makes the public key.
  * `iter+salt S2K`: [Iterated and Salted S2K](https://tools.ietf.org/html/rfc4880#section-3.7.1.3)
  * `algo: 9`: [AES with 256-bit key](https://tools.ietf.org/html/rfc4880#section-9.4)
  * `SHA1 protection`: 
  * `hash: 8`: [SHA256](https://tools.ietf.org/html/rfc4880#section-9.4)
  * `salt: 9F19C866F9DF00F4`: the [salt](https://en.wikipedia.org/wiki/Salt_(cryptography)).
  * `protect count: 65536 (96)`: 
  * `rotect IV: c5 92...`: the block size for "AES with 256-bit key" (algo=9) is: 128 bits / 16 bytes.
    The Initial Vector is 16 bytes long. 
  * `skey[2]: [v4 protected]`: The encrypted private key MPIs (encrypted with the 20-octet SHA-1 hash of the plaintext of the algorithm-specific portion).
        
## Fifth packet

Data:
        
    # off=1213 ctb=88 tag=2 hlen=2 plen=156
    :signature packet: algo 1, keyid EFC852091E95E75C
            version 4, created 1588776507, md5len 0, sigclass 0x18
            digest algo 8, begin of digest 79 42
            hashed subpkt 2 len 4 (sig created 2020-05-06)
            subpkt 16 len 8 (issuer key ID EFC852091E95E75C)
            data: 1DA723C84429B3349778A1F3CD14FB968C65B00C2C66968F9C83F947FBE09DEE36ADF82BE5E47753BBFAC066EB80409EF83611E3AF6FAFC988A54C29ADC7860F242211E1C7EDA61C98C243189FA494D3E07DBDC989B1E872442F9F232ABD81E813535F47E6C79E316D995B5FF
    FD1F5E9C24428F8E4FC2B28EA8532A04227D618

* **packet attributes**:
  * `off=1213`: the packet data starts 1213 bytes after the beginning of the document.
  * `ctb=88`: this is the first byte of the packet (`0x88`).
  * `tag=2`: [Signature Packet](https://tools.ietf.org/html/rfc4880#section-4.3)
  * `hlen=2`: this is the length of the header.
  * `plen=156`: this is the length of the payload.
* **signature**:
  * `version 4`: [Version 4 Signature Packet Format](https://tools.ietf.org/html/rfc4880#section-5.2.3)
  * `created 1588776507`: mercredi 6 mai 2020 16:48:27 GMT+02:00 DST
  * `md5len 0`
  * `sigclass 0x18`: [Subkey Binding Signature](https://tools.ietf.org/html/rfc4880#section-5.2.1)
  * `digest algo 8`: [SHA256](https://tools.ietf.org/html/rfc4880#section-9.4)
  * `begin of digest 79 42`:
  * `hashed subpkt 2 len 4`:
    * `2` represents the type of the subpacket ([Signature Creation Time](https://tools.ietf.org/html/rfc4880#section-5.2.3.1)).
    * `4` represents the length of the subpacket body (4 bytes).
  * `subpkt 16 len 8`:
    * `16` represents the type of the subpacket ([Issuer](https://tools.ietf.org/html/rfc4880#section-5.2.3.1)).
    * `8` represents the length of the subpacket.
  * `data: 1DA723C84429B3349778...`: this is the [MPI](https://tools.ietf.org/html/rfc4880#section-3.2) that represents the signature.
  
...